# ==============================================================================
# WORKFLOW: CD ECS AWS
#
# DESCRIPTION:
#   Entry point workflow for deploying containerized applications to AWS ECS.
#   This workflow calls the reusable ECS deployment workflow with specific
#   configuration parameters for the target environment.
#
# PREREQUISITES:
#   1. Repository Secrets:
#      - AWS_IAM_ROLE_ARN: IAM role ARN for AWS authentication (non-production)
#      - AWS_PROD_IAM_ROLE_ARN: IAM role ARN for AWS authentication (production)
#
#   2. Repository Variables:
#      - AWS_ACCOUNT_ID: AWS account ID for ECS resource ARNs
#
# CONFIGURATION:
#   Modify the 'with' section to configure:
#   - environment: Target deployment environment (e.g., sample, prd)
#   - ecr_repository: ECR repository name
#   - services: JSON array of ECS service names to update
#   - docker_build_args: Docker build arguments (optional)
# ==============================================================================

name: cd-ecs-aws

on:
  workflow_dispatch:

permissions:
  actions: write
  contents: read
  id-token: write

jobs:
  deploy:
    uses: ./.github/workflows/reusable-cd-ecs-aws.yml
    with:
      environment: sample
      ecr_repository: sample
      services: '["sample"]'
      docker_build_args: |
        BUILD_VERSION="${{ github.ref }}(${{ github.sha }})"
    secrets: inherit
